# LMSTUDIOを用いたユーザー情報記録・管理システム設計書

## 1. システム概要
このシステムは、LMSTUDIOの `devstral-small-2505` モデルを使用してユーザーとの会話を記録・管理するチャットシステムです。ユーザーの名前と会話内容を記録し、過去の情報を活用して応答を生成します。

## 2. メッセージ処理フロー

### 2.1 名前の推測
- ユーザーのメッセージから名前を特定
- LMSTUDIOを用いて名前を抽出し、結果を `%*name,<name>*%` の形式で返す
- 名前が不明な場合は `%*name,unknown*%` を返す

### 2.2 ファイルの確認
- 名前に対応するファイルを確認
- ファイルが存在する場合は `%*file,exists*%` を出力し、過去の情報を参照
- ファイルが存在しない場合は `%*file,new*%` を出力し、新規ユーザーとして処理

### 2.3 レスポンス生成
- LMSTUDIOを用いて過去情報を活用し、ユーザーに応答
- 新規ユーザーには「初めまして」の挨拶を生成

### 2.4 情報要約
- 会話終了時に、LMSTUDIOを用いて会話内容を要約
- 要約データを `summary:<情報内容>` の形式で提供

## 3. 技術スタックと構成

### 3.1 モデル利用
- LMSTUDIOの `devstral-small-2505` を使用してすべてのテキスト処理を実行

### 3.2 ファイル管理
- ユーザー情報はファイルシステムで管理（例: `txt` ファイル形式）

### 3.3 情報要約
- LMSTUDIOを用いて情報を要約し、次回の会話に活用可能な形で保存

### 3.4 システムプロンプト管理
- 会話の文脈に応じて、適切なプロンプトを動的に設定

## 4. 具体例

### 例1: 新規ユーザー
**入力:**
「川合です。好きな色は赤色です。」

**出力:**

```
%*name,kawai*%
%*file,new*%
初めまして、川合さん！よろしくお願いします。
```

### 例2: 既存ユーザー
**入力:**
「吉田です。さっきの話を続けましょう。」

**出力:**

```
%*name,yoshida*%
%*file,exists*%
こんにちは、吉田さん！前回の情報を基に会話を続けます。
```

### 例3: 名前不明
**入力:**
「さっき話した内容覚えてる？」

**出力:**

```
%*name,unknown*%
名前が確認できません。お名前を教えてください。
```

## 5. 実行手順

### 5.1 メッセージ受信
- ユーザーのメッセージを受け取り、LMSTUDIOを用いて名前を特定

### 5.2 ファイル操作
- 名前に基づき対応するファイルを確認
- ファイルがない場合、新規作成

### 5.3 応答生成
- LMSTUDIOで過去の情報を参照しながら応答を生成

### 5.4 情報保存
- 会話終了時、LMSTUDIOで会話内容を要約し、ファイルに保存

## 6. 注意点

### 6.1 役割分担
- プロジェクトの設計・仕様作成はこのプロンプトに基づいて行います。実行や具体的な開発作業は依頼者が行います。

### 6.2 名前の柔軟性
- 名前推測アルゴリズムは多様な入力に対応する必要があります。LMSTUDIOを使用し、正規表現や文脈理解を活用

### 6.3 拡張性
- 将来的な機能追加を考慮し、データ保存形式（例: JSON）の検討を推奨

## 7. 特記事項
- 実行は依頼者が行うため、設計のみを提供